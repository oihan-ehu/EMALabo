---
title: Zorizko aldagaiak
# author:  Itziar Irigoien, Borja Calvo, Usue Mori
date: '\mbox{ }'
classoptions: gipuzkoa, eu, foot
name: Usue Mori, Jon Vadillo, Itziar Irigoien, Borja Calvo 
course: Estatistika Metodo Aurreratuak
tel: '\mbox{ }'
mail: '[usue.mori, jon.vadillo, itziar.irigoien, borja.calvo]\@ehu.eus'
address: | 
         | Manuel de Lardizabal, 1
         | 20018 Donostia
header-includes: \usepackage{xcolor}
urlcolor: blue
output:
  pdf_document:
    keep_tex: false
---




Praktika honetan, batetik R lengoiako aspektu oinarrizko batzuk gogoratuko ditugu eta bestetik zorizko aldagaien inguruko kontzeptuak errepasatu. 

# Zorizko aldagaien definizioa: dentsitate (probabilitate-masa) eta banaketa funtzioak

Teknologia enpresa batek $X$ zorizko aldagaia erabiltzen du, astero, sare bat zenbat aldiz erortzen den modelatzeko. Aldagai honen probabilitate-masa funtzioa honakoa da:

$$f(x)=P(X=x)=\frac{e^{-1}}{x!}, \,\,\,\,\,\,\,\,\,\,\,\, x=0, 1, 2, ...$$
Hasteko definitu dezagun Rn funtzio hau eta irudikatu dezagun: 

```{r, out.height= "200px"}
#Definizioa
MasaFuntzioa <- function(x){
        return(exp(-1)/factorial(x))
}

#Irudikapena
x <- 0:20
plot(x, MasaFuntzioa(x), type="b", ylab="P(X=x)")
``` 

\bigskip

\sffamily\fboxrule.1em\fboxsep1em
\fcolorbox{black}{yellow}{\color{black}
  \begin{minipage}[c][0.5cm][t]{15cm}
  \textbf{Ariketa:} Kalkulatu `MasaFuntzioa` funtzioa erabiliz $P(X=1)$, $P(X>3)$ eta $P(X<=11)$.
  \end{minipage}}

\bigskip

```{r}
# P(X=1)
MasaFuntzioa(1)
# P(X>3)
1 - sum(MasaFuntzioa(0:3))
# P(X<=11)
sum(MasaFuntzioa(0:11))
```
 

\bigskip

\sffamily\fboxrule.1em\fboxsep1em
\fcolorbox{black}{yellow}{\color{black}
  \begin{minipage}[c][1cm][t]{15cm}
  \textbf{Ariketa:} Definitu `BanaketaFuntzioa` funtzioa $X$ aldagaiaren probabilitate metatua ematen duena $F(x)=P(X \leq x)$ eta kalkulatu funtzio hori erabiliz $P(X>3)$ eta $P(X<=11)$. Saiatu funtzioa definitzean `sapply` funtzioa erabiltzen `for` ziklo bat beharrean.
  \end{minipage}}

\bigskip

```{r}

BanaketaFuntzioa <- function(x) {
  return(sum(sapply(0:x, MasaFuntzioa)))
}

# P(X>3)
1 - BanaketaFuntzioa(3)
# P(X<=11)
BanaketaFuntzioa(11)

```


# Banaketa ezagunak aztertzeko Rko funtzioak

Apur bat fijatuz gero, erraz ikus daiteke, $X$ aldagaia $\lambda=1$ parametroko Poisson banaketa bat dela. Hau horrela izanik, Rk definituta dauzka hainbat funtzio banaketa ezagunekin lan egitea asko erraztuko digutenak. 

Hasteko, dentsitate edo probabilitate masa funtzioa `dbanaketa` motako funtzioetan dago definituta, gure kasuan `dpois` funtzioan, hain zuzen ere:

```{r}
dpois(x=1, lambda=1) #P(X=1)
```

\bigskip

\sffamily\fboxrule.1em\fboxsep1em
\fcolorbox{black}{yellow}{\color{black}
  \begin{minipage}[c][0.5cm][t]{15cm}
  \textbf{Ariketa:} $X$ aldagaiari jarraituz, zein da aste batean sarea 2 aldiz erortzeko probabilitatea?
  \end{minipage}}

```{r}
dpois(x=2, lambda = 1)
```
\bigskip

Gainera, probabilitate metatuaren funtzioa `pbanaketa` motako funtzioetan aurki dezakegu:

```{r}
ppois(q=2, lambda=1, lower.tail=TRUE) #P(X<=2)
```

\bigskip

\sffamily\fboxrule.1em\fboxsep1em
\fcolorbox{black}{yellow}{\color{black}
  \begin{minipage}[c][0.5cm][t]{15cm}
  \textbf{Ariketa:} Erabili Rren laguntza `ppois` funtzioa zuzenean erabiliz $P(X>4)$ nola kalkulatzen den ikasteko.
  \end{minipage}}


```{r}
ppois(q=4, lambda = 1, lower.tail = FALSE)
```
\bigskip

Hirugarrenik, banaketaren kuantilak eta pertzentilak `qbanaketa` motako funtzioekin lor ditzakegu:

```{r}
qpois(p=0.5, lambda=1, lower.tail=TRUE) #P(X<=a)=0.5
```

\bigskip

\sffamily\fboxrule.1em\fboxsep1em
\fcolorbox{black}{yellow}{\color{black}
  \begin{minipage}[c][0.5cm][t]{15cm}
  \textbf{Ariketa:} Zer esan nahi du aurreko kode zatian lortutako zenbakiak? Nola deitzen da balio hori?
  \end{minipage}}


Balio horren ezkerrean banaketaren erdia dagoela, horri mediana deitzen zaio

\bigskip

Azkenik, edozein banaketa ezaguneko ausazko lagin bat lortzeko `rbanaketa` motako funtzioak erabil ditzakegu. Adibidez Poisson(1) banaketatik 10 aleko lagin bat honela lor dezakegu:

```{r}
rpois(10, lambda=1)
```

\bigskip

\sffamily\fboxrule.1em\fboxsep1em
\fcolorbox{black}{yellow}{\color{black}
  \begin{minipage}[c][0.5cm][t]{15cm}
  \textbf{Ariketa:} Aurreko kodean lortutako lagina $X$ aldagaiaren lagin bat bada, zer esan nahi dute balioek? Suposatu orain $X~Poisson(4)$ dela. Lortu ausazko lagin bat eta esan nola aldatu diren balioak.
  \end{minipage}}

Balioak esperimentu baten hamar lagin dira


```{r}
rpois(10, lambda=4)
```

Laginak handiagoak dira

\bigskip

# Ariketak

**1. ariketa** $X$ zorizko aldagaiak ondorengo dentsitate-funtzioa du: 
$$f(x)= \left\{
\begin{array}{cc}
1 - |1-x| , &  0 < x < 2\\
0 , & \mbox{bestela}
\end{array}
 \right.$$
 
+ Definitu eta irudikatu dentsitate-funtzioa. Horren arabera, zein da $EX$? Adierazi itxaropena aurreko grafikoan lerro bertikal berde bat gehituz.


```{r}
f <- function(x) {
  if (x <= 0 | x >= 2) return(0)
  return(1-abs(1-x))
}

x <- seq(-1, 3, 0.1)
f <- Vectorize(f)
plot(x, f(x), type = "l")

#EX = 1 da

abline(v = 1, col = "green")

```


 
+ Kalkulatu dagokion banaketa-funtzioa eskuz eta marraztu. Horren arabera, zein da $Q_3$?

\[
F(x) =\int_{-\infty}^{x} f(t)\,dt  = \int_0^x f(t)\,dt =
\left\{\begin{array}{@{}l@{\thinspace}l}
  0 &: x < 0\\
  \int_0^x t\,dt &: 0 \le x \le 1 \\
  \int_0^1 t\,dt + \int_1^x(2-t)\,dt &: 1 < x \le 2 \\
  1 &: 2 < x
\end{array}\right. =
\left\{\begin{array}{@{}l@{\thinspace}l}
  0 &: x < 0\\
  \frac{x^2}{2} &: 0 \le x \le 1 \\
  2x - \frac{x^2}{2} - 1 &: 1 < x \le 2 \\
  1 &: 2 < x
\end{array}\right.
\]

Honen arabera:

\[
P(X\le a)=\frac{3}{4}  \implies F(a) = \frac{3}{4} \implies 2a - \frac{a^2}{2} - 1 = \frac{3}{4} \implies
a = 2 - \frac{1}{\sqrt{2}} \simeq 1.2929
\]

+ Begiratu Rko laguntzan `integrate` funtzioari buruzko informazioa. Erabili funtzio hau $EX$ kalkulatzeko eta banaketa-funtzioa zuzenean lortzeko (eskuz kalkulatu gabe).

```{r}
#EX
integrate(function(x){x * f(x)}, 0, 2)

banaketaF <- function(y){
  integrate(f, 0, y)
}

#F(Q_3)
Q_3 = 2 - 1/sqrt(2)
banaketaF(Q_3)

```

 
\bigskip


**2. ariketa** Zorizko aldagai jarraituen hainbat **banaketa ezagunekin** lan egingo dugu. Kasu bakoitzean:

 | Banaketak|  |      |
 |:-----|:-----|:-----|
 |$X \sim \mathcal{U}(0,1)$|$X \sim Beta(1,1)$|$X \sim Beta(15,1)$|
 |$X \sim Beta(15,15)$|$X \sim Exp(5)$|$X \sim Gamma(5, 10)$|
 |$X \sim N(5, 10)$| $X \sim N(5, 1)$| $X \sim t_{2}$|
 |$X \sim t_{30}$| $X \sim \chi^2_1$ |$X \sim \chi^2_6$|
 
+ Marraztu dentsitate-funtzioa. Horren arabera ondorioztatu gutxi-gora-behera $EX$ren balioa. Egiaztatu teoriako emaitzekin.
+ Kalkulatu $x_0$ non $P(X \leq x_0) = 0.9$ den.
+ Kalkulatu $P(X < a)$, zuk aukeratutako $a < EX$ balio baterako.

\bigskip

$$X \sim \mathcal{U}(0,1)$$

$$f(x)= \left\{
\begin{array}{ccc}
\frac{1}{b-a} & , &  a\le x\le b\\
0 & , & \mbox{bestela}
\end{array}
 \right.$$
 
```{r}
f <- function(x){
  if (x < 0 || x > 1) return(0)
  1
}

f <- Vectorize(f)
```
 
 
```{r}

x <- seq(-1, 2, length.out = 3001)
dentsitatea <- f(x)

plot(x, dentsitatea, t="l", main = "Unif(0, 1)")
abline(v=0.5)


# x_0 | P(X<= x_0) = 0.9
qunif(0.9, 0, 1)
# P(X < a) | a < EX
# a = 0.3
punif(0.3)

```
 
 $EX = \frac{a+b}{2}$ eta $VAR(X) = \frac{(b-a)^2}{12}$
 
\bigskip


$$X \sim Beta(1,1)$$



```{r}

x <- seq(-1, 2, length.out = 3001)
dentsitatea <- dbeta(x, 1, 1)

plot(x, dentsitatea, t="l", main = "Beta(1, 1)")
abline(v=0.5)

# x_0 | P(X<= x_0) = 0.9
qbeta(0.9, 1, 1)
# P(X < a) | a < EX
# a = 0.3
pbeta(0.3, 1, 1)

```

$EX = \frac{\alpha}{\alpha+\beta}$ eta $VAR(X) = \frac{\alpha\beta}{(\alpha+\beta)^2(\alpha+\beta+1)}$

 \bigskip

$$X \sim Beta(15,1)$$

```{r}

x <- seq(-0.1, 1.1, length.out = 3001)
dentsitatea <- dbeta(x, 15, 1)

plot(x, dentsitatea, t="l", main = "Beta(15, 1)")
abline(v=15/16)

# x_0 | P(X<= x_0) = 0.9
qbeta(0.9, 15, 1)
# P(X < a) | a < EX
# a = 14/16
pbeta(14/16, 15, 1)

```

 \bigskip

$$X \sim Beta(15,15)$$

```{r}

x <- seq(-0.1, 1.1, length.out = 3001)
dentsitatea <- dbeta(x, 15, 15)

plot(x, dentsitatea, t="l", main = "Beta(15, 15)")
abline(v=15/30)

# x_0 | P(X<= x_0) = 0.9
qbeta(0.9, 15, 15)
# P(X < a) | a < EX
# a = 0.3
pbeta(0.3, 15, 15)

```

\bigskip

$$X \sim Exp(5)$$


$$f(x)= \left\{
\begin{array}{ccc}
\lambda e^{-\lambda x} & , &  x \ge0\\
0 & , & \mbox{bestela}
\end{array}
 \right.$$
 
 
```{r}

x <- seq(-0.1, 3, length.out = 3001)
dentsitatea <- dexp(x, 5)

plot(x, dentsitatea, t="l", main = "Exp(5)")
abline(v=1/5)

# x_0 | P(X<= x_0) = 0.9
qexp(0.9, 5)
# P(X < a) | a < EX
# a = 1/6
pexp(1/6, 5)
```
 
 $EX = \frac{1}{\lambda}$ eta $VAR(X) = \frac{1}{\lambda^2}$
 
 \bigskip
 
 $$X \sim Gamma(5, 10)$$
 
```{r}

x <- seq(-0.1, 3, length.out = 3001)
dentsitatea <- dgamma(x, 5, 10)

plot(x, dentsitatea, t="l", main = "Gamma(5, 10)")
abline(v=1/2)

# x_0 | P(X<= x_0) = 0.9
qgamma(0.9, 5, 10)
# P(X < a) | a < EX
# a = 0.3
pgamma(0.3, 5, 10)

```
 
 $EX = \frac{\alpha}{\beta}$ eta $VAR(X) = \frac{\alpha}{\beta^2}$
 
 \bigskip
 
 
 $$X \sim N(5, 10)$$
 
 $$f(x) = \frac{1}{\sqrt{2\pi}\sigma}e^{-\frac{(x-\mu)^2}{2\sigma^2}}$$
 
```{r}
x <- seq(-25, 35, length.out = 3001)
dentsitatea <- dnorm(x, 5, 10)

plot(x, dentsitatea, t="l", main = "N(5, 10)")
abline(v=5)

# x_0 | P(X<= x_0) = 0.9
qnorm(0.9, 5, 10)
# P(X < a) | a < EX
# a = 4
pnorm(4, 5, 10)

```
 
 $EX = \mu$ eta $VAR(X) = \sigma^2$
 
 \bigskip
 
 $$X \sim N(5, 1)$$
 
```{r}

x <- seq(-25, 35, length.out = 3001)
dentsitatea <- dnorm(x, 5, 1)

plot(x, dentsitatea, t="l", main = "N(5, 1)")
abline(v=5)

# x_0 | P(X<= x_0) = 0.9
qnorm(0.9, 5, 1)
# P(X < a) | a < EX
# a = 4
pnorm(4, 5, 1)

```
 
$$X \sim t_{2}$$
 
```{r}

x <- seq(-25, 35, length.out = 3001)
dentsitatea <- dt(x, 2)

plot(x, dentsitatea, t="l", main = "TStudent_2")
abline(v=0)

# x_0 | P(X<= x_0) = 0.9
qt(0.9, 2)
# P(X < a) | a < EX
# a = -1
pt(-1, 2)

```
 $EX=0$ eta $VAR(X) = \frac{n}{n-2}$
 
 \bigskip
 
 $X \sim t_{30}$
 
```{r}

x <- seq(-25, 35, length.out = 3001)
dentsitatea <- dt(x, 30)

plot(x, dentsitatea, t="l", main = "TStudent_30")
abline(v=0)

# x_0 | P(X<= x_0) = 0.9
qt(0.9, 30)
# P(X < a) | a < EX
# a = -1
pt(-1, 30)

```

\bigskip

$$X \sim \chi^2_1$$

```{r}

x <- seq(-0.1, 5, length.out = 3001)
dentsitatea <- dchisq(x, 1)

plot(x, dentsitatea, t="l", main = "Ki-karratu_1")
abline(v=1)

# x_0 | P(X<= x_0) = 0.9
qchisq(0.9, 1)
# P(X < a) | a < EX
# a = 0.1
pchisq(0.1, 1)

```

\bigskip

$$X \sim \chi^2_6$$


```{r}

x <- seq(-0.1, 16, length.out = 3001)
dentsitatea <- dchisq(x, 6)

plot(x, dentsitatea, t="l", main = "Ki-karratu_6")
abline(v=6)

# x_0 | P(X<= x_0) = 0.9
qchisq(0.9, 6)
# P(X < a) | a < EX
# a = 5
pchisq(5, 6)

```

$EX=n$ eta $VAR(X) = 2n$


